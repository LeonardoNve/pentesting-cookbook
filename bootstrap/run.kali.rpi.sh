#!/usr/bin/env bash
if [ "$(id -u)" != "0" ]; then
    echo 'Must be run as root!' 1>&2
    exit 1
fi

if [ ! $USERNAME ]; then
    echo '$USERNAME variable must be set!' 1>&2
    exit 1
fi

export DEBIAN_FRONTEND=noninteractive

OLD_PWD=$PWD

subsource() {
    echo -e "\e[33;1;3m░▒▓ $2 ▓▒░\e[0m"
    . $1
    cd $OLD_PWD
}

subsource 'kali.locale.sh' 'Setting locale'
subsource 'kali.update.sh' 'Updating'
subsource 'kali.deps.base.sh' 'Installing base packages'
subsource 'kali.deps.src.sh' 'Installing external packages'
subsource 'kali.deps.rpi.sh' 'Installing RPi packages'
subsource 'kali.env.sh' 'Configuring environment'
subsource 'kali.hardening.sh' 'Hardening'

echo -e "\e[32;1;5mDone!\e[0m"
